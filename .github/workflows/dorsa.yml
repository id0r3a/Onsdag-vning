# .github/workflows/deploy.yml
name: Deploy

on:
  workflow_dispatch:
    inputs:
      env:
        description: "Environment to deploy to"
        required: true
        default: development         # MÅSTE matcha ett faktiskt environment
        type: choice
        options: [development, production]

jobs:
  deploy:
    runs-on: ubuntu-latest

    # Binder jobbet till environmentet så GitHub fyller i github.environment
    environment:
      name: ${{ inputs.env }}

    steps:
      - name: Print target environment (should NOT be empty)
        run: |
          echo "inputs.env='${{ inputs.env }}'"
          echo "github.environment='${{ github.environment }}'"

      - name: Echo masked secret (only in development)
        if: ${{ github.environment == 'development' }}
        run: echo "MY_API_KEY (masked):${{ secrets.MY_API_KEY }}"

      - name: Use secret in a command (only in development)
        if: ${{ github.environment == 'development' }}
        run: curl -H "Authorization:Bearer ${{ secrets.MY_API_KEY }}" https://example.com/ping || true
